<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>DeviceStudio ä½¿ç”¨æ‰‹å†Œ</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
/* ===== ä¸»é¢˜å˜é‡ ===== */
:root{
  /* æµ…è‰²ï¼ˆé»˜è®¤ï¼‰ */
  --bg:#ffffff;
  --panel:#f5f7fa;
  --card:#ffffff;
  --primary:#1e88e5;
  --text:#222222;
  --gray:#666666;
  --radius:6px;
  --sideW:260px;
  --shadow:0 2px 8px rgba(0,0,0,.08);
}
/* æ·±è‰² */
[data-theme="dark"]{
  --bg:#0d1b2a;
  --panel:#122335;
  --card:#1a2a3a;
  --primary:#64b5f6;
  --text:#e3f2fd;
  --gray:#90a4ae;
  --shadow:0 2px 8px rgba(0,0,0,.4);
}
/* ===== åŸºç¡€æ ·å¼ ===== */
*{box-sizing:border-box;}
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif;background:var(--bg);color:var(--text);line-height:1.6;transition:background .3s,color .3s;}
a{color:var(--primary);}
h1,h2,h3{scroll-margin-top:80px;}
h1{font-size:2em;margin:.3em 0;}
h2{font-size:1.5em;margin:.8em 0 .4em;padding-left:.6em;border-left:4px solid var(--primary);}
h3{font-size:1.2em;margin:.6em 0 .3em;}
/* é¡¶éƒ¨æ  */
header{
  position:fixed;
  top:0;
  left:0;
  right:0;
  height:60px;
  background:var(--panel);
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 24px;
  z-index:10;
  box-shadow:var(--shadow);
}
header h1{margin:0;font-size:1.4em;font-weight:500;}
#themeToggle{
  background:none;border:none;font-size:24px;cursor:pointer;
  color:var(--primary);transition:transform .3s;
}
#themeToggle:hover{transform:scale(1.15);}
/* å¸ƒå±€ */
.container{display:flex;margin-top:60px;}
#sidebar{
  width:var(--sideW);
  background:var(--panel);
  height:calc(100vh - 60px);
  overflow-y:auto;
  padding:16px;
  position:sticky;
  top:60px;
  flex-shrink:0;
  transition:background .3s;
}
#sidebar ul{list-style:none;margin:0;padding:0;}
#sidebar li{margin:6px 0;}
#sidebar a{
  display:block;
  padding:8px 12px;
  border-radius:var(--radius);
  color:var(--gray);
  transition:background .2s,color .2s;
   text-decoration: none
}
#sidebar a.active,
#sidebar a:hover{
  background:var(--primary);
  color:#fff;
}
#content{
  flex:1;
  padding:24px 32px;
  max-width:900px;
}
/* åœ¨æ ·å¼è¡¨ä¸­æ·»åŠ  */
.figure-caption {
  text-align: center;       /* å±…ä¸­å¯¹é½ */
  color: var(--gray);       /* ä½¿ç”¨ä¸»é¢˜ç°è‰² */
  font-size: 0.9em;         /* å­—ä½“ç¨å° */
  font-style: normal;       
  margin: 8px 0 24px;       /* ä¸Šä¸‹è¾¹è· */
  line-height: 1.5;         /* è¡Œé«˜ */
}
#sidebar a.h2 {
  font-weight: bold;        /* åŠ ç²— */
  font-size: 1.1em;         /* å­—ä½“ç¨å¤§ */
  margin: 12px 0 6px;       /* ä¸Šä¸‹è¾¹è· */
}

#sidebar a.h3 {
  font-weight: normal;      /* æ­£å¸¸å­—é‡ */
  font-size: 0.95em;        /* å­—ä½“ç¨å° */
  margin-left: 16px;        /* å·¦ä¾§ç¼©è¿› */
}
/* å›¾ç‰‡çƒ­ç‚¹ */
.hotspot-img{
  position:relative;
  display:inline-block;
  line-height:0;
  margin:16px 0;
}
.hotspot-img img{
  max-width:100%;
  border-radius:var(--radius);
}
.hotspot-img svg{
  position:absolute;
  left:0;
  top:0;
  width:100%;
  height:100%;
  pointer-events:none;
}
.hotspot-img svg a{
  pointer-events:all;
}
.hotspot-img svg polygon{
  fill:rgba(30,136,229,.08);
  stroke:var(--primary);
  stroke-width:2;
  transition:fill .2s;
}
.hotspot-img svg a:hover polygon{
  fill:rgba(30,136,229,.2);
}
/* ç§»åŠ¨ç«¯æŠ˜å æŒ‰é’® */
#toggle{
  display:none;
}
@media(max-width:768px){
  #toggle{
    display:block;
    position:fixed;
    bottom:20px;
    right:20px;
    width:48px;
    height:48px;
    border-radius:50%;
    background:var(--primary);
    color:#fff;
    border:none;
    font-size:20px;
    cursor:pointer;
    box-shadow:var(--shadow);
  }
  #sidebar{
    position:fixed;
    left:-100%;
    transition:left .3s;
    z-index:9;
  }
  #sidebar.show{
    left:0;
  }
}
</style>
</head>
<body>
<header>
  <h1>DeviceStudio ä½¿ç”¨æ‰‹å†Œ</h1>
  <button id="themeToggle" aria-label="åˆ‡æ¢ä¸»é¢˜">ğŸŒ</button>
</header>

<div class="container">
  <!-- å·¦ä¾§å¯¼èˆª -->
  <aside id="sidebar">
    <ul id="nav"></ul>
  </aside>

  <!-- ä¸»å†…å®¹ -->
  <main id="content">
    <h1 id="top">DeviceStudio ä½¿ç”¨æ‰‹å†Œ</h1>
    <p>å­¦ä¹ è¿™ä¸ªè½¯ä»¶ä¹‹å‰ï¼Œå»ºè®®å…ˆäº†è§£ä¸€ä¸‹VASPã€‚è¿™ä¸ªè½¯ä»¶çš„è®¡ç®—æœ¬è´¨ä¸Šæ˜¯å›¾å½¢ç‰ˆçš„VASPï¼Œå‚æ•°è®¾ç½®å’ŒVASPåŸºæœ¬ç›¸åŒã€‚</p>

    <h2 id="1-quick">1 å®‰è£…ä¸èµ„æºé›†åˆ</h2>
  <ul>
    <li>å®˜æ–¹ä¸»é¡µï¼ˆå®‰è£…ï¼‰ï¼š<a href="https://cloud.hzwtech.com/web/product-service?id=6" target="_blank">https://cloud.hzwtech.com</a></li>
    <li>å®˜æ–¹æ•™ç¨‹ï¼š<a href="https://hzwtech.com/Help/StartedGuide.html#si" target="_blank">Device StudioåŸºæœ¬ä½¿ç”¨æŒ‡å—</a></li>
    <li>ç»“æ„ä¼˜åŒ–å’Œèƒ½å¸¦æ•™ç¨‹ï¼š<a href="https://hzwtech.com/Device%20Studio/DS-PAW/build/html/introduction.html" target="_blank">DS-PAWä½¿ç”¨æŒ‡å—</a></li>
    <li>æ™¶ä½“ç»“æ„æŸ¥æ‰¾ï¼š<a href="https://next-gen.materialsproject.org/materials" target="_blank">Materials Projectï¼ˆéœ€è¦æ³¨å†Œï¼‰</a></li>
    <li>VASPå‚æ•°è®¾ç½®è®ºå›åˆ†äº«ï¼š<a href="https://www.cnblogs.com/" target="_blank">åšå®¢å›­</a></li>
  </ul>

    <h2 id="2-DSè½¯ä»¶ç•Œé¢åŠŸèƒ½">2 DSè½¯ä»¶ç•Œé¢åŠŸèƒ½</h2>
    <h3 id="2-1-ä¸»ç•Œé¢æŒ‰é’®">2.1 ä¸»ç•Œé¢æŒ‰é’®</h3>
    <div class="hotspot-img">
      <img id="ä¸»ç•Œé¢åŸºæœ¬æ¡†æ¶" src="/Webtext/ä¸»ç•Œé¢åŸºæœ¬æ¡†æ¶.png" alt="å›¾1 ä¸»ç•Œé¢">
         <svg viewBox="0 0 800 400"><a href="#2-2-build"><polygon points="65,0 85,0 85,20 65,20"/></a></svg>
         <svg viewBox="0 0 800 400"><a href="#2-3-Simulator"><polygon points="95,0 115,0 115,20 95,20"/></a></svg>
    </div>
    <p class="figure-caption">å›¾ 1 ä¸»ç•Œé¢ä»‹ç»ï¼ˆç‚¹å‡»è“è‰²è¾¹æ¡†å¯è·³è½¬ç›¸åº”ç« èŠ‚ï¼‰</p>
    
    <h3 id="2-2-build">2.2 build</h3>
    <div class="hotspot-img">
      <img id="fig2" src="/Webtext/build.png" alt="å›¾2 build" style="width: 60%; max-width: 600px; display: block; margin: 0 auto;">
    </div>
    <p class="figure-caption">å›¾2 build</p>

    <h3 id="2-3-simulator">2.3 simulator</h3>
    <div class="hotspot-img">
      <img id="fig3" src="/Webtext/simulator.png" alt="å›¾2 simulator" style="width: 70%; max-width: 600px; display: block; margin: 0 auto;">
    </div>
    <p class="figure-caption">å›¾3 simulator</p>

    <h3 id="2-4-WinSCP">2.4 WinSCP</h3>
    <p >WinSCPä¸»è¦ç”¨äºè¿æ¥è¿œç¨‹æœåŠ¡å™¨ï¼Œä¸‹è½½ç»“æ„æ–‡ä»¶ã€‚</p>

    <h3 id="2-5-æœåŠ¡å™¨åˆ‡æ¢åŠè®¾ç½®">2.5 æœåŠ¡å™¨åˆ‡æ¢åŠè®¾ç½®</h3>
    <p>ç”¨äºåˆ‡æ¢ä¸åŒçš„è®¡ç®—æœåŠ¡å™¨ã€‚selectå¯ä»¥åˆ‡æ¢æœåŠ¡å™¨ã€‚</p>
    <p>ç›®å‰æ”¯æŒçš„æœåŠ¡å™¨æœ‰ï¼š
        <ul>
            <li>Mycomputer(ç”¨è‡ªå·±çš„ç”µè„‘ç®—)</li>
            <li>å†…è’™AåŒºï¼ˆBåŒºï¼‰ï¼ˆç›®å‰çš„äº‘å†…å­˜å·²æ»¡ï¼Œå»ºè®®ä½¿ç”¨å…¶ä»–æœåŠ¡å™¨ï¼‰</li>
            <li>å¹¶è¡Œäº‘åŒºï¼ˆæ¯”è¾ƒå¸¸ç”¨ï¼‰</li>
            <li>ååŒ—äº‘åŒºï¼ˆå‡ ä¹æ²¡äººç”¨è¿‡ï¼‰</li>
            <li>å…¶ä»–äº‘åŒºä¸æ¸…æ¥šäº†</li>
        </ul>
    </p>

    <h2 id="3-æ¨¡æ‹Ÿè®¡ç®—">3 æ¨¡æ‹Ÿè®¡ç®—</h2>
    <h3 id="3-1-åˆ†å­ç»“æ„å»ºæ¨¡">3.1 åˆ†å­ç»“æ„å»ºæ¨¡</h3>
    <p><strong><li>æ–¹æ³•ä¸€ï¼šå¯¼å…¥å®Œæ•´ç»“æ„æ¨¡å‹</strong></p></li>
    <p>1.åœ¨DSä¸»ç•Œé¢çš„Fileèœå•ä¸­é€‰æ‹©Import/Onlineï¼Œå¯æŸ¥æ‰¾è½¯ä»¶è‡ªå¸¦çš„ç¤ºä¾‹ç»“æ„æ–‡ä»¶ã€‚</p>
    <p>2.ä»Materials Projectç½‘ç«™ä¸‹è½½ã€‚</p>
    <p><strong><li>æ–¹æ³•äºŒï¼šè‡ªå»ºç»“æ„æ¨¡å‹</strong></p></li>
    <p>1.å·²çŸ¥ç»“æ„ä¿¡æ¯ï¼Œåœ¨Build/Moleculeä¸‹è¾“å…¥åŸå­å’Œä½ç½®ä¿¡æ¯å»ºæ¨¡ã€‚</p>
    <p>2.æœªçŸ¥ç»“æ„ä¿¡æ¯ï¼Œæƒ³è¿˜åŸæ–‡çŒ®ä¸­çš„ç»“æ„æ¨¡å‹ï¼Œä¼˜å…ˆå¯¼å…¥å·²çŸ¥ç»“æ„ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œæ›¿æ¢å’Œä¿®é¥°ã€‚å¦‚ï¼šç¡…çƒ¯ç»“æ„å¯å¯¼å…¥çŸ³å¢¨çƒ¯ç»“æ„è¿›è¡Œæ›¿æ¢ã€‚</p>
    <p>3.å®åœ¨æ˜¯æ²¡æœ‰ç»“æ„ä¿¡æ¯ï¼Œåªèƒ½è‡ªå·±æ‰‹æ“ã€‚</p>
    <div class="hotspot-img">
      <img id="fig4" src="/Webtext/æ™¶èƒå»ºæ¨¡.png" alt="å›¾4 æ™¶èƒå»ºæ¨¡">
    </div>
    <p class="figure-caption">å›¾ 4ï¼šæ™¶èƒå»ºæ¨¡ï¼ˆé‡Œé¢æ²¡æœ‰çš„åªèƒ½è‡ªå·±æ¢ç´¢äº†ï¼‰</p>

    <h3 id="3-2-ç»“æ„ä¼˜åŒ–">3.2 ç»“æ„ä¼˜åŒ–</h3>
    <div class="hotspot-img">
      <img id="fig5" src="/Webtext/ç»“æ„ä¼˜åŒ–1.png" alt="å›¾5 ç»“æ„ä¼˜åŒ–1">
    </div>
    <p class="figure-caption">å›¾ 5ï¼šç»“æ„ä¼˜åŒ–Relaxtionè®¾ç½®</p>
    <p><strong><li>éƒ¨åˆ†å‚æ•°è§£é‡Šå¦‚ä¸‹ï¼š</strong></p></li>
    <p><strong>Number of stepsï¼š</strong>ç»“æ„ä¼˜åŒ–æ­¥æ•°ä¸Šé™ï¼Œå»ºè®®300æ­¥å·¦å³ã€‚</p>
    <p><strong>Force toleranceï¼š</strong>ç»“æ„ä¼˜åŒ–åŠ›é˜ˆå€¼ï¼Œå»ºè®®0.01 eV/Ã…ã€‚</p>
    <p><strong>Degrees of freedomï¼š</strong>é¦–æ¬¡ä¼˜åŒ–å‹¾é€‰Relax allï¼Œåç»­ä¼˜åŒ–ï¼ˆçœ‹æƒ…å†µï¼‰å¯ä»¥å‹¾é€‰Relax atom positionsã€‚</p>
    <p><strong>Constraintsï¼š</strong>ç»“æ„ä¼˜åŒ–çº¦æŸï¼Œå‹¾é€‰Lattice constraintsã€‚è®¾ç½®å¦‚ä¸‹å›¾</p>
    <div class="hotspot-img">
      <img id="fig6" src="/Webtext/ç»“æ„å›ºå®šè®¾ç½®.png" alt="å›¾6 ç»“æ„å›ºå®šè®¾ç½®">
    </div>
    <p class="figure-caption">å›¾ 6ï¼šç»“æ„ä¼˜åŒ–Lattice constraintsè®¾ç½®</p>
    <div class="hotspot-img">
      <img id="fig7" src="/Webtext/ç»“æ„ä¼˜åŒ–2.png" alt="å›¾5 ç»“æ„ä¼˜åŒ–2">
    </div>
    <p class="figure-caption">å›¾ 7ï¼šç»“æ„ä¼˜åŒ–Solver settingè®¾ç½®</p>
    <p><strong><li>éƒ¨åˆ†å‚æ•°è§£é‡Šå¦‚ä¸‹ï¼š</strong></p></li>
    <p><strong>k-point samplingï¼š</strong>èƒ½å¸¦è®¡ç®—kç‚¹ç½‘æ ¼ï¼Œn1ã€n2ã€n3åˆ†åˆ«å¯¹åº”xã€yã€zæ–¹å‘çš„kç‚¹ç½‘æ ¼æ•°ï¼Œè¿™ä¸ªæ•°xæ™¶æ ¼å¸¸æ•°açš„å€¼å¤§æ¦‚åœ¨40å·¦å³å°±è¡Œã€‚
      ä¾‹å¦‚a=3Ã…ï¼Œn1=12ï¼Œn2=12ï¼Œn3=12ã€‚é‚£ä¹ˆæ˜¯ä½¿ç”¨Gamma-centeredè¿˜æ˜¯Monkhorst-Packç½‘æ ¼(ä»¥ä¸‹æ˜¯<a href="http://bbs.keinsci.com/thread-5429-1-1.html" target="_blank">ç½‘ä¸Šçš„å»ºè®®</a>)ã€‚</p>
    <p>å¥‡æ•°çš„æ—¶å€™ï¼Œmå’Œgæ˜¯ä¸€æ ·çš„ã€‚</p> 
    <p>kç‚¹å°çš„æ—¶å€™ä¸€èˆ¬æ˜¯gï¼Œä¸”ç”¨å¶æ•°ã€‚</p>
    <p>kç‚¹å¤šçš„æ—¶å€™ï¼Œç”¨mçš„å¥‡æ•°ï¼Œæˆ–è€…Gçš„å¥‡å¶ã€‚</p>
    <p><strong>cut-offï¼š</strong>æˆªæ–­èƒ½è®¾ç½®ï¼Œå»ºè®®500eVï¼Œè®¡ç®—æ‚åŒ–æ—¶å¦‚æœè®¡ç®—æ—¶é—´è¿‡ä¹…å¯ä»¥æ”¹æˆ400eVã€‚</p>
    <p><strong>Symmteryï¼š</strong>æ˜¯å¦ä½¿ç”¨å¯¹ç§°æ€§è®¡ç®—ã€‚</p>
    <p><strong>Convergenceï¼š</strong>å‹¾é€‰ï¼ŒEnergy toleranceï¼Œå»ºè®®1e-5ã€‚ï¼ˆæ ¹æ®è®¡ç®—è¦æ±‚ç²¾åº¦è°ƒæ•´ï¼‰</p>
  
    <div class="hotspot-img">
      <img id="fig8" src="/Webtext/ç»“æ„ä¼˜åŒ–3.png" alt="å›¾8 ç»“æ„ä¼˜åŒ–3">
    </div>
    <p class="figure-caption">å›¾ 8ï¼šç»“æ„ä¼˜åŒ–Physical settingsè®¾ç½®</p>
    <p><strong>Van der Waals:</strong>è‰²æ•£çŸ«æ­£ï¼ˆä¸€èˆ¬æ¥è®²æ˜¯å‹¾é€‰ï¼Œå…¶ä»–æƒ…å†µçœ‹ç€åŠï¼‰ï¼Œå…³äºå®ƒçš„ä¸‰ç§ç±»å‹å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« 
      <a href="http://sobereva.com/210" target="_blank">DFT-Dè‰²æ•£æ ¡æ­£çš„ä½¿ç”¨</a>ã€‚</p>
    <p>ä¸åŒçš„äººæå‡ºè¿‡ä¸åŒçš„è‰²æ•£æ ¡æ­£æ–¹æ³•ï¼Œå¦‚TSã€XDMã€VV10ç­‰ï¼Œå…¶ä¸­æœ€æˆåŠŸã€ä¹Ÿæ˜¯ç›®å‰æœ€ä¸ºæµè¡Œçš„æ˜¯Grimmeæå‡ºçš„DFT-Dï¼Œæœ‰ä»¥ä¸‹ç‰ˆæœ¬:
    <li>(1) JCC,25,1463(2004)ï¼š<strong>DFT-D1</strong>ã€‚å·²è¿‡æ—¶</li>
    <li>(2) JCC,27,1787(2006)ï¼š<strong>DFT-D2</strong>ã€‚å·²è¿‡æ—¶</li>
    <li>(3) JCP,132,154104(2010)ï¼š<strong>DFT-D3</strong>ã€‚æ¯”DFT-D2æ›´ä¸¥è°¨ï¼Œæ•´ä½“ç²¾åº¦æ›´å¥½ï¼Œæ”¯æŒå…ƒç´ æ›´å¤šï¼ˆæ”¯æŒä»Håˆ°Puï¼‰ï¼Œå¯¹å‡ ä¹æ‰€æœ‰ä¸»æµæ³›å‡½éƒ½æä¾›äº†å‚æ•°ï¼Œè€Œä¸”å‡ ä¹ä¸ä»¤è®¡ç®—è€—æ—¶æœ‰ä»»ä½•å¢åŠ ï¼Œå®ç°ä¹Ÿå¾ˆå®¹æ˜“ï¼Œå¦‚ä»Šå‡ ä¹æ‰€æœ‰ä¸»æµé‡åŒ–ç¨‹åºéƒ½æ”¯æŒDFT-D3</li>
    <li>(4) JCP,147,034112(2017)ï¼š<strong>DFT-D4</strong>ã€‚æ¯”DFT-D3çš„æ”¹è¿›åœ¨äºå¯ä»¥è€ƒè™‘å®é™…ç”µå­ç»“æ„å¯¹è‰²æ•£æ ¡æ­£èƒ½çš„å½±å“ï¼Œä½†è®¡ç®—æ–¹å¼å¤æ‚å¾—å¤šï¼Œç›®å‰åªæœ‰è¾ƒå°‘ç¨‹åºæ”¯æŒ</li>
    </p>
    <p><strong>æœ€åæ˜¯å…³äºç£æ€§çš„è®¡ç®—ï¼Œæ²¡ç»éªŒï¼Œåªèƒ½è‡ªå·±æ‘¸ç´¢äº†ã€‚</strong></p>

    <h3 id="3-3-èƒ½å¸¦è®¡ç®—">3.3 èƒ½å¸¦è®¡ç®—</h3>
    <div class="hotspot-img">
      <img id="fig9" src="/Webtext/èƒ½å¸¦è®¡ç®—.png" alt="å›¾9 èƒ½å¸¦è®¡ç®—">
    </div>
    <p class="figure-caption">å›¾ 9ï¼šèƒ½å¸¦è®¡ç®—è®¾ç½®</p>
    <p><strong>SCFï¼š</strong>è‡ªæ´½åœºè®¡ç®—ï¼Œå‹¾é€‰Wave functionså’ŒBaderã€‚</p>
    <p><strong>Density of stateså’ŒBand structureï¼š</strong>éƒ½å‹¾é€‰ï¼Œè¿™æ˜¯ä¸€æ­¥ç®—çš„æ­¥éª¤ï¼Œè¿˜æœ‰åˆ†ä¸¤æ­¥ç®—çš„å¯ä»¥çœ‹å®˜ç½‘çš„<a href="https://hzwtech.com/Device%20Studio/DS-PAW/build/html/introduction.html" target="_blank">æ“ä½œæ‰‹å†Œ</a>ã€‚</p>

    <h2 id="4-æ¡ˆä¾‹">4 æ¡ˆä¾‹</h2>
    <h3 id="4-1-AlN">4.1 AlNè¡¨é¢ç”Ÿé•¿çŸ³å¢¨çƒ¯</h3>

    <h2 id="history">ç‰ˆæœ¬å†å² &amp; åé¦ˆé€šé“</h2>
    <ul>
      <li>æ›´æ–°æ—¥æœŸï¼š2025-12-16</li>

    </ul>

  </main>
</div>

<button id="toggle" aria-label="æŠ˜å ä¾§è¾¹æ ">â˜°</button>

<script>
/* ä¾§è¾¹æ ç”Ÿæˆ + é«˜äº® */
const nav=document.getElementById('nav');
const heads=document.querySelectorAll('#content h2,#content h3');
const frag=document.createDocumentFragment();
heads.forEach(h=>{
  const a=document.createElement('a');
  a.textContent=h.textContent;
  a.href='#'+h.id;
  a.className=h.tagName.toLowerCase();
  const li=document.createElement('li');
  li.appendChild(a); frag.appendChild(li);
});
nav.appendChild(frag);

function updateActive(){
  let cur=null;
  heads.forEach(h=>{
    if(h.getBoundingClientRect().top<=80) cur=h;
  });
  nav.querySelectorAll('a').forEach(a=>a.classList.remove('active'));
  if(cur) nav.querySelector('a[href="#'+cur.id+'"]')?.classList.add('active');
}
window.addEventListener('scroll',updateActive); updateActive();

/* ç§»åŠ¨ç«¯æŠ˜å  */
const toggle=document.getElementById('toggle');
const sidebar=document.getElementById('sidebar');
toggle.addEventListener('click',()=>sidebar.classList.toggle('show'));

/* æ·±æµ…ä¸»é¢˜åˆ‡æ¢ + æœ¬åœ°å­˜å‚¨ */
const themeKey='ds-theme';
const body=document.documentElement;
const btn=document.getElementById('themeToggle');

function applyTheme(t){
  body.setAttribute('data-theme',t);
  btn.textContent=t==='dark'?'ğŸŒœ':'ğŸŒ';
  localStorage.setItem(themeKey,t);
}
const saved=localStorage.getItem(themeKey);
applyTheme(saved||(window.matchMedia('(prefers-color-scheme: dark)').matches?'dark':'light'));

btn.addEventListener('click',()=>{
  const curr=body.getAttribute('data-theme');
  applyTheme(curr==='dark'?'light':'dark');
});
</script>
</body>
</html>
